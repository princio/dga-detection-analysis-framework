Windows Client VM 1

Day 1 The Windows Client VM 1 was
operated by a user over the whole workday. The guidelines for the user
operating the device included browsing social networks, watching videos,
downloading images, seeing the news, sending emails, trying internet speed,
joining video calls, and reading research papers. During the day, there was
also one reboot of the device to increase the virtual machine’s resources. At
16:30 CET, the simulation of a workday ended. Tabs were left open in the
device.
Day 2 Started at 7:36 CET with human-generated benign traffic. After
a few minutes of generation, the device was infected with the first malware
sample called NanoCore adware
(f26c9aff73c041c5a506b8e8ede7bc50fe468d34b0cbf750940bb195eb068b0b). The
malware was executed at 7:42:35 CET. During the rest of the day, benign
traffic occasionally was generated by a human operator.
On Day 3, it was found that VirtualBox capture was not enabled for this
device (but the central capture in the storage device was done correctly).
Therefore the device was turned off at 9:14 CET to enable the PCAP capture
in Virtualbox. The NanoCore adware, which was already infected on this
device before rebooting, started again without the need for manual execution.
During the day, benign traffic was generated by a human operator. The
benign activities mostly include the activities described on day 1. In the
afternoon, Windows Client VM 1 was infected with another malware sample,
making it infected with two simultaneous samples. The RHADAMANTHYS
info stealer
(e09f0bd79308d5a35381b2921ca5f0f609225120157de3d093554eb4b611839e) was
executed at 16:06:19 CET.
On Day 4 and Day 5, we continued with the occasional human-generated
benign traffic. Furthermore, the malicious traffic provided by the two running
malware samples continued as well.
In general, day 6 was the day when all devices were taken back to their
clean state. On day 6, the Windows Client VM 1 device was reset to a
benign snapshot (which was captured on day two at 7:33 CET). The rollback
was done at 13:42 CET. After this action, the device was left without any
interaction, so all its traffic was benign.
During Day 7, the whole traffic of the device was benign and without
human interaction.


Windows Client VM 2

During day 1, the Windows Client VM 1 was operated by a user over the
whole workday. The guidelines for the user operating the device included
browsing social networks, watching videos, downloading images, seeing the
news, sending emails, trying internet speed, joining video calls, and reading
research papers. During the day, there was also one reboot of the device to
increase the virtual machine’s resources. At 16:30 CET, the simulation of a
workday ended. Tabs were left open in the device.
On Day 2, the human-generated benign traffic started at 7:47 CET. After a
few minutes of traffic generation, the device got infected with its first malware
sample, called Redlinestealer
(3c7883524728e43e640e1b53d4ce65d582cf7b7c42ca2baf3371ac752ddc216d). The
malware was executed at 7:50:00 CET. During the rest of the day, together
with the malware, some benign traffic was occasionally generated by a human
user.
On Day 3, it was found that the VirtualBox PCAP capture was not
enabled for this device. Therefore the device was turned off at 9:14 CET to
enable the capture. After starting the VM again, the Redlinestealer malware
was still running without the need for manual execution. During the day,
benign traffic was generated by a human operator. Redlinestealer was still
running on this device.
On Day 4, the Windows Client VM 2 was rolled back to a benign snapshot
at 9:37:40 CET. After the device booted up again, a user operator generated
a bit of benign traffic. After this, the device was infected with the malware
AgentTesla
(9625958ccd5b7aa03607ca23df3d239ee90a64021a998ab4d8fe71f664155e6a) at
9:53:30 CET. For the rest of the day, together with the malware, a human
user was browsing the internet occasionally.
On day 5 at 8:50:00 CET, the device was infected with the Lockbit 2.0
ransomware
(74437ac6c9f630c52c7e230d57d38c4cbc3affb3bec9215f090a0e3dca8e9d78).
The malware encrypted files in this device, and after, it also accessed remote
files in the AD Windows Server using the SMB protocol and also encrypted
those. The ransomware did not manage to spread using shared domain
credentials, but it was able to encrypt files that were shared across multiple
devices in the domain. To confirm this hypothesis, during the day, some extra
folders were shared using SMB in the Windows AD server, and the remote
encryption was confirmed. The Windows Client VM1 and Windows Client
VM3 were left with no extra folders shared.
On day 6 at 14:28 CET, the Windows Client VM2 was rolled back to a
benign snapshot taken on day two at 7:33 CET. After this action, the device
was left without any human interaction.
On day 7, there was no user interaction with the Windows Client VM 2
device, and only the default Windows traffic and open applications traffic
was generated.


Windows Client VM 3

During day 1, the Windows Client VM 3 was operated by a user over the
whole workday. The guidelines for the user operating the device included
browsing social networks, watching videos, downloading images, seeing the
news, sending emails, trying internet speed, joining video calls, and reading
research papers. During the day, there was also one reboot of the device to
increase the virtual machine’s resources. At 16:30 CET, the simulation of a
workday ended. Tabs were left open in the device.
On day 2, the device was occasionally operated by a human user. At
12:41:19 CET, the device was infected with the malware called RemcosRAT
(08c829e7056b8e022539076acbc962dea072e6506184d4036b785cb0e4592371).
During the rest of the day, the malware was left running.
On day 3, there was no notable user action performed. Most of the
traffic was generated by the malware and by the operating system and other
computers connecting to it.
Day 4 on Windows Client VM 3 was dedicated to data exfiltration attacks.
The exfiltration was done using the PyExfil python library [29]. This library
can do DNS exfiltration. DNS exfiltration was chosen for this scenario
because it is one of the most common and easy-to-do exfiltration attack. The
exfiltration was performed to a server under our control in the Digital Ocean
cloud, where a real DNS server was set up. The exfiltration was performed in
4 degrees of intensity, where each degree lasted 2 hours:
- 14:40:10 CET Exfiltrate over DNS with delay between packets = 0.1s and payload size = 10B
- 16:59:00 CET Exfiltrate over DNS with delay between packets = 0.1s and payload size = 128B
- 19:10:00 CET Exfiltrate over DNS with delay between packets = 5s and payload size = 10B
- 21:25:00 CET Exfiltrate over DNS with delay between packets = 5s and payload size = 128B
For DNS exfiltration, 10 bytes is considered small, and 128 bytes is consid-
ered quite high. The maximum length of a domain name is 256 characters.
On Day 5, Lockbit 2.0 ransomware
(74437ac6c9f630c52c7e230d57d38c4cbc3affb3bec9215f090a0e3dca8e9d78) was
executed on Windows VM2, which could have taken advantage of the shared
domain account. To our best knowledge, this ransomware did not use this
vulnerability. Therefore we believe the Windows VM3 device remained benign
until the rest of the experiment.
On day 6 similarly to Windows Client VM2 and Windows Client VM3,
the device was rolled back at 14:28 CET to a benign snapshot (taken on day
two at 7:33 CET).
There was no interaction with the device on day 7.


Windows Server VM AD

Day 1 matches the activities of day 1 of the Windows VM 1. Additionally,
there was some minor setup done in the server management console on this
device.
On day 2 the Windows Server VM AD was attacked from the Ubuntu server.
The attack included trying to log into the AD and resources enumeration of
shared folders via the Metasploit attack framework.
On day 3, the Windows VM AD was infected with Trickbot malware
(1e90b6fc99a908420de123418deded8d8eadf2114ac43ee1ec366681b5358c17) at
16:15:51 CET. Before this malware execution, the device was occasionally
operated by a human user performing routine actions.
Day 4 brought no notable action on Windows Server VM AD. The Trickbot
malware, which infected this device on day 3, was still running untouched,
and the device was used for benign purposes by a human operator in the
background.
On Day 5, the virtual machine was rolled back to a snapshot taken after
day 1. After it was cleaned, it got infected with the ransomware called Lockbit
2.0 which originated from Windows VM2. The malware did not manage to
get full access to the VM. Therefore, only folders shared with the Windows
Client VM 2 were encrypted.
The Windows Server VM AD was rolled back to a benign state once more
on day 6 at 14:28 CET. After this rollback, no further interaction was done
with the machine by a human operator.
There was no interaction with the device on day 7.


Ubuntu VM

On day 1, the Ubuntu VM was operated by a human user during the whole
workday. The activities on this device included the installation of packages
(net-tools, vim, htop, vscode), browsing the internet, trying the internet speed,
downloading and reading research papers, installation of Miniconda and basic
python packages, installation of Docker and pulling a small Docker image,
and watching YouTube videos.
From 10:45 CET to 10:49 CET the Ubuntu VM was rebooted to increase
the assigned resources so it would be easier to operate.
On day 2, the Ubuntu VM was infected with PWNrig crypto-miner
(4495b55b4f0634def0c91b044b178f5404c8b18effd871d0a06634d15830fe0e) at
7:58:44 CET. However, as the malware took most of the VMs resources and
made the machine unusable, the device was reset back at 10:35 CET on day
2 to a benign snapshot taken after on day 2 at 7:33 CET. For the rest of the
day, the device was used by human operator to attack the Ubuntu VM. The
attack started at 14:06:45 CET and ended at 15:25:20 CET.
On day 3, at 16:26:03 CET the PWNrig crypto-miner was run again, but
now using the nice command with a priority of 20 (sudo nice -n 20 pwnrig.elf).
Additionally, benign traffic continued as before, with human users accessing
the VM and using it for minor operations.
On day 4, 5he Ubuntu VM was reset back to a benign snapshot at 9:07:39
CET. After it was cleaned up, new malware was run on this device. At 9:19:34
CET, the device was infected with Kinsing malware  (be0fe6a1344b052d4f61cca910f7d26ad02d283f280014eeca0d1cc729e6822a).
This malware was scanning a very large number of IP addresses. Therefore,
it was terminated on the same day at 16:42 CET by resetting the VM back
to a benign snapshot.
The original plan for day 5 was to infect the Ubuntu VM with Linux
ransomware. Unfortunately, we were unable to find Linux ransomware that
would send network traffic from the device. Therefore, we decided to infect
the device with the Lupper worm
(2f09fd9d1d76f5fef5b8608326d25847824e6b3eef939727deb985ff2ac0ae07) at
18:46:24 CET. As this malware was scanning IP addresses on the internet,
we stopped the infection at 21:30 CET on the same day.
Day 6 was a cleaning day for all the machines, including Ubuntu VM. It
was rolled back to a benign snapshot at 13:42 CET. After this rollback, no
further interaction was done with the machine from user operators.
On day 7 there was no further interaction from user operators with the
device, however, all the benign and automatic traffic from the OS remained.


MacOS laptop

Day 1 was designated to generate human-generated benign traffic. On
the MacOS device, this included browsing social networks, watching videos,
downloading images or PDFs, seeing the news, sending emails using online
web email services, uploading files to Dropbox and Google Drive, checking
internet speed, reading and downloading research papers, and backing up
data to iCloud.
On day 2, the human-generated benign traffic started at 9:51 CET. The
device was then infected with Nukesped RAT
(dced1acbbe11db2b9e7ae44a617f3c12d6613a8188f6a1ece0451e4cd4205156) at
10:05:13 CET. For the rest of the day, the device was used for minor benign
activities by several human users. This malware sample was attributed to a
North Korean cyber actor, probably named Lazarus Group or APT38 1 .
Day 3 did not bring any new malware infection. The Nukepsed malware
was still running on the MacOS laptop, and the device was occasionally used
by a user to browse the internet. It is worth mentioning that on this day,
the Brew package manager and XCode developer tools were installed on the
device.
On day 4, the device was reset back to the benign state on using Time
machine backup. The process started at 8:23:22 CET and was finished at
approximately 8:41 CET. After a few minutes of human-generated benign
traffic, the device was infected with a new malware sample. RealTimeSpy
spyware
(11ce12eaa7740581c7ea8cfde45fd84c4255dbb201a5aafb4085bfcc3ea66aab) was
executed at 8:58:35 CET.
For day 5, a ransomware was planned. The laptop was once again reset to
a benign state at 15:05 CET. After the reset finished, Evilquest ransomware
(9e8c30955ccb5797efaab676ffdf36fe08ce32d4aab4d18e1a9ed2be43d5db0f) was
executed on this device at 15:57:15 CET.
The device was reset back to a benign state using a Time machine backup
on day 6. The process started at 13:30 CET. After it finished, no further
actions were done with this machine.
There was no user interaction with the device on day 7.


iOS phone

From day 1 to day 5, the iOS device was used for benign activities by
a user. The activities included IoT devices control, browsing social media,
installing applications from App Store, playing music and videos, and playing
games. There was no malicious traffic on this device.
There was no interaction with the device on day 6 and day 7.


Android phone

From day 1 to day 5, the Android device was used for benign activities by a
user for browsing social media, installing applications from App Store, playing
music and videos, and playing games. Note that the Android phone was
already powered on and working when the first day was started, and therefore
the traffic shows already benign ongoing connections from this device.
On day 2, the device was infected with the Octo RAT malware
(144cb58badccd0d201ef6b9befef75f7a2860cf6b978b14d9acf9b77a6a3fdfb) at
10:11:01 CET.
During the rest of day 3, and whole day 4 and day 5 the Android device
only had the Octo RAT malware running and the default activities of the
OS. The infection was stopped by factory resetting the device on day 6 at
13:14 CET. After factory resetting the device, the randomization of the MAC
address needs to be turned off again. This was done at 13:39 CET.
There was no user interaction with the device on Day 7.


Raspberry Pi

On day 1, the first interaction with the Raspberry Pi device was our own
administrative connection at 16:15 to manage it using SSH from the IP
address 192.168.1.209. At 16.17 we installed the Kodi media center 2 on the
Raspberry Pi. Apart from these actions, no interaction with this device was
made on day 1. This device was exposed to the internet by having its own
public IP address in the main router. This IP address received attacks from
the internet during the whole of day 1. However, since the SSH password
of the admin user was very strong on day 1 no attack was successful to log


Alexa Echo

in. We verified this using the capability of Zeek to identify successful SSH
logins and our own research verification. However, all the attempts from the
internet were considered and labeled as malicious attacks.
At 10:04 on day 2, the credentials on the Raspberry for the admin user
were changed to admin, making it vulnerable to attacks from the internet.
This setting remained unchanged until day 6. The first successful attack and
login to SSH from the internet happened on day 2 at 11:04:14 CET.
During day 3, day 4 and day 5, the device was kept with an easy-to-
guess weak password on the admin account and reachable from the internet.
Therefore it received many attacks, which were labeled.
On day 6, the device was restored to a benign state by swapping the
SD card in the device. Therefore the device was made resistant to internet
attacks.
There was no user interaction with the device on Day 7.


Alexa Echo

Similarly to the Raspberry Pi and Google Chromecast, the Alexa Echo
assistant was assigned its own public IP address in the main router. Therefore,
it was visible and attacked from the internet. To our best knowledge, the
Alexa assistant has not been exploited.
During day 1, day 2, day 3, day 4, day 5, and day 6 the Alexa Echo
assistant was occasionally used by a user using their voice to deliver the news,
play games, stream music, or answer questions of the researchers.
There was no user interaction with the device on Day 7.


Chromecast

Similarly to the Raspberry Pi and Alexa Echo, the Google Chromecast device
was assigned a public IP address in the main router. Therefore, it was visible
and attacked from the internet. To our best knowledge, the Chromecast
device has not been exploited.
During day 1, day 2, day 3, day 4, day 5 and day 6 the Google
Chromecast was used for streaming videos from Youtube on the local monitor.
There was no user interaction with the device on Day 7.